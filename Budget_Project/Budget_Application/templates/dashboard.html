<!DOCTYPE html>
{% load static %}
<html>
<head>
  <title>Interaktywne wykresy</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
.chart-row {
  display: flex;
  justify-content: space-around;  /* lub space-between */
  flex-wrap: wrap;                /* pozwala zawijać na mniejszych ekranach */
  margin-top: 20px;
}

.chart-container {
  width: 45%;
  min-width: 300px;
  max-width: 300px;
}
.date-filter-container {
  display: flex;
  justify-content: center;
  margin-top: 20px;
}

.date-form {
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap; /* Żeby wyglądało dobrze na telefonie */
}

  </style>
</head>
<body>
  {% include 'navbar.html' %}
<div class="date-filter-container">
  <form method="get" class="date-form">
    <label>Od: <input type="date" name="start_date" value="{{ start_date }}"></label>
    <label>Do: <input type="date" name="end_date" value="{{ end_date }}"></label>
    <button type="submit" class="btn btn-primary">Filtruj</button>
  </form>
</div>
<div class="chart-row">
  <div class="chart-container">
    <h3>Wydatki</h3>
    <canvas id="expenseChart"></canvas>
  </div>
  <div class="chart-container">
    <h3>Przychody</h3>
    <canvas id="incomeChart"></canvas>
  </div>
</div>

  <script>
    // Dane do wydatków (expense)
    const expenseLabels = {{ expense_labels|safe }};
    const expenseValues = {{ expense_values|safe }};

    // Dane do przychodów (income)
    const incomeLabels = {{ income_labels|safe }};
    const incomeValues = {{ income_values|safe }};

    // Konfiguracja wykresu wydatków
    const ctxExpense = document.getElementById('expenseChart').getContext('2d');
    const expenseChart = new Chart(ctxExpense, {
      type: 'pie',
      data: {
        labels: expenseLabels,
        datasets: [{
          data: expenseValues,
          backgroundColor: [
            'rgba(255, 99, 132, 0.6)',
            'rgba(54, 162, 235, 0.6)',
            'rgba(255, 206, 86, 0.6)',
            'rgba(75, 192, 192, 0.6)',
          ],
          borderColor: 'rgba(255, 255, 255, 1)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'right' },
          tooltip: { enabled: true }
        }
      }
    });

    // Konfiguracja wykresu przychodów
    const ctxIncome = document.getElementById('incomeChart').getContext('2d');
    const incomeChart = new Chart(ctxIncome, {
      type: 'pie',
      data: {
        labels: incomeLabels,
        datasets: [{
          data: incomeValues,
          backgroundColor: [
            'rgba(255, 159, 64, 0.6)',
            'rgba(153, 102, 255, 0.6)',
            'rgba(255, 205, 86, 0.6)',
            'rgba(201, 203, 207, 0.6)',
          ],
          borderColor: 'rgba(255, 255, 255, 1)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'right' },
          tooltip: { enabled: true }
        }
      }
    });
  </script>
</body>
</html>
